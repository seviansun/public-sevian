/*
Copyright 2012, KISSY UI Library v1.30dev
MIT Licensed
build time: Mar 31 21:37
*/
KISSY.add("component/Controller",function(k,i,f,c,d){function g(a){return function(b){b=b.newVal;var e=this.get("view");e&&e.set(a,b)}}function h(a){return function(b){var e=this.get("view");return b===undefined?e&&e.get(a):b}}function l(a,b,e){a.create();var j=a.getContentElement();b.__set("parent",a);b.set("render",j);b.set("elBefore",e);a.get("rendered")?b.render():b.create()}function m(a){if(a.__componentClasses)return a.__componentClasses;for(var b=a.constructor,e=[];b&&b!=n;){var j=c.getClsByUI(b);
j&&e.push(j);b=b.superclass&&b.superclass.constructor}return a.__componentClasses=e.join(" ")}var n=f.create([f.Box],{__CLASS:"Component.Controller",getCls:c.getCls,initializer:function(){var a=this.__attrs||{},b;for(b in a)if(a.hasOwnProperty(b)){var e=a[b];if(e.view){this.on("after"+(b.charAt(0).toUpperCase()+b.substring(1))+"Change",g(b));e.getter=h(b)}}},renderUI:function(){var a,b;this.get("view").render();var e=this.get("children");for(a=0;a<e.length;a++){b=e[a];l(this,b);b.render()}},createDom:function(){var a;
if(!(a=this.get("view"))){a=this.constructor;for(var b;a&&!b;){b=a.DefaultRender;a=a.superclass&&a.superclass.constructor}if(b){a=this.__attrs||{};var e={},j;for(j in a)if(a.hasOwnProperty(j)){var o;if(a[j].view)if((o=this.get(j))!==undefined)e[j]=o}a=new b(e)}else a=0}b=a;b.create();b._renderCls(m(this));this.get("allowTextSelection_")||b.get("el").unselectable();this.__set("view",b)},getContentElement:function(){var a=this.get("view");return a&&a.getContentElement()},addChild:function(a,b){var e=
this.get("children"),j=null;if(b!==undefined){e.splice(b,0,a);j=e[b]||null}else e.push(a);l(this,a,j)},removeChild:function(a,b){var e=this.get("children"),j=k.indexOf(a,e);j!=-1&&e.splice(j,1);b&&a.destroy()},removeChildren:function(a){var b,e=[].concat(this.get("children"));for(b=0;b<e.length;b++)this.removeChild(e[b],a);this.__set("children",[])},getChildAt:function(a){return this.get("children")[a]},_uiSetHandleMouseEvents:function(a){var b=this.get("el");if(a){b.on("mouseenter",this._handleMouseEnter,
this);b.on("mouseleave",this._handleMouseLeave,this);b.on("mousedown",this._handleMouseDown,this);b.on("mouseup",this._handleMouseUp,this);b.on("dblclick",this._handleDblClick,this)}else{b.detach("mouseenter",this._handleMouseEnter,this);b.detach("mouseleave",this._handleMouseLeave,this);b.detach("mousedown",this._handleMouseDown,this);b.detach("mouseup",this._handleMouseUp,this);b.detach("dblclick",this._handleDblClick,this)}},_handleDblClick:function(a){this.get("disabled")||this._performInternal(a)},
_isMouseEventWithinElement:function(a,b){var e=a.relatedTarget;if(!e)return false;if(e===b[0]||b.contains(e))return true},_handleMouseOver:function(a){var b=this.get("el");if(this.get("disabled"))return true;this._isMouseEventWithinElement(a,b)||this._handleMouseEnter(a)},_handleMouseOut:function(a){var b=this.get("el");if(this.get("disabled"))return true;this._isMouseEventWithinElement(a,b)||this._handleMouseLeave(a)},_handleMouseEnter:function(){if(this.get("disabled"))return true;this.set("highlighted",
true)},_handleMouseLeave:function(){if(this.get("disabled"))return true;this.set("active",false);this.set("highlighted",false)},_handleMouseDown:function(a){var b;if(this.get("disabled"))return true;a.which==1&&this.get("activeable")&&this.set("active",true);b=this.getKeyEventTarget();a.which==1&&b.attr("tabindex")>=0&&b[0].focus();if(a.which==1&&!this.get("allowTextSelection_")){b=(b=a.target.nodeName)&&b.toLowerCase();b!="input"&&b!="textarea"&&a.preventDefault()}},_uiSetFocusable:function(a){var b=
this.getKeyEventTarget();if(a){b.on("focus",this._handleFocus,this);b.on("blur",this._handleBlur,this);b.on("keydown",this._handleKeydown,this)}else{b.detach("focus",this._handleFocus,this);b.detach("blur",this._handleBlur,this);b.detach("keydown",this._handleKeydown,this)}},_uiSetFocused:function(a){this._forwardSetAttrToView("focused",a)},_uiSetHighlighted:function(a){this._forwardSetAttrToView("highlighted",a)},_forwardSetAttrToView:function(a,b){var e=this.get("view");e["_set"+(a.charAt(0).toUpperCase()+
a.substring(1))].call(e,b,m(this))},_uiSetDisabled:function(a){this._forwardSetAttrToView("disabled",a)},_uiSetActive:function(a){this._forwardSetAttrToView("active",a)},getKeyEventTarget:function(){return this.get("view").getKeyEventTarget()},_handleMouseUp:function(a){if(this.get("disabled"))return true;if(this.get("active")&&a.which==1){this._performInternal(a);this.set("active",false)}},_handleFocus:function(){this.set("focused",true)},_handleBlur:function(){this.set("focused",false)},_handleKeyEventInternal:function(a){if(a.keyCode==
i.KeyCodes.ENTER)return this._performInternal(a)},_handleKeydown:function(a){if(this.get("disabled"))return true;if(this._handleKeyEventInternal(a)){a.halt();return true}},_performInternal:function(){},destructor:function(){var a,b=this.get("children");for(a=0;a<b.length;a++)b[a].destroy();(a=this.get("view"))&&a.destroy()}},{ATTRS:{handleMouseEvents:{value:true},focusable:{view:true,value:true},activeable:{value:true},focused:{},active:{},highlighted:{},children:{value:[]},prefixCls:{view:true,value:"ks-"},
parent:{},view:{},disabled:{},allowTextSelection_:{value:false}},DefaultRender:d});return n},{requires:["event","uibase","./uistore","./render"]});KISSY.add("component",function(k,i,f,c,d,g,h,l){k={Controller:i,Render:f,Container:c,UIStore:d,DelegateChildren:g,DecorateChild:l,DecorateChildren:h};k.Controller=i;return k},{requires:["component/Controller","component/render","component/container","component/uistore","component/delegatechildren","component/decoratechildren","component/decoratechild"]});
KISSY.add("component/container",function(k,i,f,c,d,g){return i.create(f,[d,g])},{requires:["uibase","./Controller","./uistore","./delegatechildren","./decoratechildren"]});KISSY.add("component/decoratechild",function(k,i){function f(){}k.augment(f,i,{decorateInternal:function(c){this.set("el",c);var d=this.get("decorateChildCls"),g=this.get("prefixCls");if(c=c.one("."+this.getCls(d)))(d=this._findUIByClass(c))?this.decorateChildrenInternal(d,c,g):this.decorateChildren(c)}});return f},{requires:["./decoratechildren"]});
KISSY.add("component/decoratechildren",function(k,i){function f(){}k.augment(f,{decorateInternal:function(c){this.set("el",c);this.decorateChildren(c)},decorateChildrenInternal:function(c,d,g){this.addChild(new c({srcNode:d,prefixCls:g}))},_findUIByClass:function(c){c=c.attr("class")||"";var d=this.get("prefixCls");c=c.replace(RegExp("\\b"+d,"ig"),"");return i.getUIByClass(c)},decorateChildren:function(c){var d=this;c=c.children();var g=d.get("prefixCls");c.each(function(h){var l=d._findUIByClass(h);
d.decorateChildrenInternal(l,h,g)})}});return f},{requires:["./uistore"]});
KISSY.add("component/delegatechildren",function(k){function i(){}k.augment(i,{__bindUI:function(){this.get("el").on("mousedown mouseup mouseover mouseout dblclick",this._handleChildMouseEvents,this)},_handleChildMouseEvents:function(f){var c=this.getOwnerControl(f.target);if(c)switch(f.type){case "mousedown":c._handleMouseDown(f);break;case "mouseup":c._handleMouseUp(f);break;case "mouseover":c._handleMouseOver(f);break;case "mouseout":c._handleMouseOut(f);break;case "dblclick":c._handleDblClick(f)}},
getOwnerControl:function(f){for(var c=this.get("children"),d=c.length,g=this.get("el")[0];f&&f!==g;){for(var h=0;h<d;h++)if(c[h].get("el")[0]===f)return c[h];f=f.parentNode}return null}});return i});
KISSY.add("component/render",function(k,i,f){function c(d,g,h){return d.getCls(g.split(/\s+/).join(h+" ")+h)}return i.create([i.Box.Render],{__CLASS:"Component.Render",_completeClasses:function(d,g){return c(this,d,g)},_renderCls:function(d){this.get("el").addClass(this.getCls(d))},getCls:f.getCls,getKeyEventTarget:function(){return this.get("el")},getContentElement:function(){return this.get("contentEl")||this.get("el")},_uiSetFocusable:function(d){var g=this.getKeyEventTarget(),h=g.attr("tabindex");
if(h>=0&&!d)g.attr("tabindex",-1);else!(h>=0)&&d&&g.attr("tabindex",0)},_setHighlighted:function(d,g){this.get("el")[d?"addClass":"removeClass"](c(this,g,"-hover"))},_setDisabled:function(d,g){this.get("el")[d?"addClass":"removeClass"](c(this,g,"-disabled")).attr({tabindex:d?-1:0,"aria-disabled":d})},_setActive:function(d,g){this.get("el")[d?"addClass":"removeClass"](c(this,g,"-active")).attr("aria-pressed",!!d)},_setFocused:function(d,g){this.get("el")[d?"addClass":"removeClass"](c(this,g,"-focused"))}},
{ATTRS:{prefixCls:{},focusable:{}}})},{requires:["uibase","./uistore"]});
KISSY.add("component/uistore",function(k){function i(c){for(var d in f)if(f[d].ui==c)return d;return 0}var f={};return{getCls:function(c){c=k.trim(c).split(/\s+/);for(var d=0;d<c.length;d++)if(c[d])c[d]=this.get("prefixCls")+c[d];return c.join(" ")},getClsByUI:i,getClsByInstance:function(c){return i(c.constructor)},getUIByClass:function(c){c=c.split(/\s+/);for(var d=null,g=0;g<c.length;g++){var h=f[c[g]];if(h&&h.priority>-1)d=h.ui}return d},setUIByClass:function(c,d){f[c]=d},PRIORITY:{LEVEL1:10,LEVEL2:20,
LEVEL3:30,LEVEL4:40,LEVEL5:50,LEVEL6:60}}});
